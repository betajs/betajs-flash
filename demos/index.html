<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script src="../vendors/beta.js"></script>
		<script src="../dist/betajs-flash.js"></script>
	</head>
	<body>
		<script>
			var registry = new BetaJS.Flash.FlashClassRegistry();
			registry.register("flash.media.Video", ["attachNetStream"]);
			registry.register("flash.display.Sprite", ["addChild"]);
			registry.register("flash.net.NetStream", ["play"]);
			registry.register("flash.net.NetConnection", ["connect"]);

			$("body").html(BetaJS.Flash.Helper.embedTemplate({
				flashFile: "../dist/betajs-flash.swf",
				forceReload: true
			}));
			var embedding = new BetaJS.Flash.FlashEmbedding($("embed").get(0), {
				registry: registry,
				wrap: true
			});
			
			embedding.ready(function () {
				var main = embedding.flashMain();
				var video = embedding.newObject("flash.media.Video", 500, 500);
				main.addChildVoid(video);
				var connection = embedding.newObject("flash.net.NetConnection");
				connection.addEventListener("netStatus", function () {
					var stream = embedding.newObject("flash.net.NetStream", connection);
					
					stream.set("client", embedding.newCallback("onMetaData", function (info) {
						console.log(info);
					}));
					
					video.attachNetStreamVoid(stream);
					stream.playVoid(document.location + "/../movie.mp4");

					//stream.playVoid("abc.flv");
				});
				connection.connectVoid(null);

				//connection.connectVoid("rtmp://localhost:1935/vodtest/_definst_");
			});
		</script>
	</body>
</html>