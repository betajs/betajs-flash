/*!
betajs-flash - v0.0.1 - 2015-04-01
Copyright (c) Oliver Friedmann
MIT Software License.
*/
var Scoped=function(){function a(a){function b(a){return d.extend({route:null,parent:null,children:{},watchers:[],data:{},ready:!1,lazy:[]},a)}function c(a){if(!a.ready){if(a.parent&&!a.parent.ready)return void c(a.parent);if(a.route in a.parent.data){a.data=a.parent.data[a.route],a.ready=!0;for(var b=0;b<a.watchers.length;++b)a.watchers[b].callback.call(a.watchers[b].context||this,a.data);a.watchers=[];for(var d in a.children)c(a.children[d])}}}function e(b){if(!b.ready){b.parent&&!b.parent.ready&&e(b.parent),b.ready=!0,a.tree&&"object"==typeof b.parent.data&&(b.parent.data[b.route]=b.data);for(var c=0;c<b.watchers.length;++c)b.watchers[c].callback.call(b.watchers[c].context||this,b.data);b.watchers=[]}}function f(a,b){if("object"==typeof b)for(var d in b)a.data[d]=b[d],a.children[d]&&(a.children[d].data=b[d]);else a.data=b;e(a);for(var f in a.children)c(a.children[f])}function g(a){if(a.ready&&a.data)for(var b in a.data)delete a.data[b]}function h(a){if(!a)return j;for(var d=a.split("."),e=j,f=0;f<d.length;++f)d[f]in e.children?e=e.children[d[f]]:(e.children[d[f]]=b({parent:e,route:d[f]}),e=e.children[d[f]],c(e));return e}function i(a,b,c){if(a.ready)b.call(c||this,a.data);else if(a.watchers.push({callback:b,context:c}),a.lazy.length>0){var d=function(a){if(a.lazy.length>0){var b=a.lazy.shift();b.callback.call(b.context||this,a.data),d(a)}};d(a)}}a=d.extend({tree:!1,global:!1,root:{}},a);var j=b({ready:!0}),k=null;if(a.tree){if(a.global){try{window&&(k=window)}catch(l){}try{global&&(k=global)}catch(l){}}else k=a.root;j.data=k}return{extend:function(a,b){f(h(a),b)},set:function(a,b){var c=h(a);c.data&&g(c),f(c,b)},lazy:function(a,b,c){var d=h(a);d.ready?b(c||this,d.data):d.lazy.push({callback:b,context:c})},digest:function(a){c(h(a))},obtain:function(a,b,c){i(h(a),b,c)}}}function b(e,f,g,h){var i=null,j=[],k=a({tree:!0}),l=a({tree:!1}),m={global:{namespace:h},root:{namespace:g},local:{namespace:k},"default":{namespace:l},parent:{namespace:f},scope:{namespace:k,readonly:!1}},n=function(a,b,c){var e=d.matchArgs(a,{options:"object",namespaceLocator:!0,dependencies:"array",hiddenDependencies:"array",callback:!0,context:"object"}),f=d.extend({lazy:this.options.lazy},e.options||{}),g=this.resolve(e.namespaceLocator),h=function(){this.require(e.dependencies,e.hiddenDependencies,function(){if(arguments[arguments.length-1].ns=g,this.options.compile){for(var f=[],h=0;h<a.length;++h)f.push(d.stringify(a[h]));this.compiled+=this.options.ident+"."+b+"("+f.join(", ")+");\n\n"}var i=e.callback.apply(e.context||this,arguments);c.call(this,g,i)},this)};return f.lazy?g.namespace.lazy(g.path,h,this):h.apply(this),this};return{getGlobal:d.method(c,c.getPath),setGlobal:d.method(c,c.setPath),options:{lazy:!1,ident:"Scoped",compile:!1},compiled:"",nextScope:function(){return i||(i=b(this,k,g,h)),i},subScope:function(){var a=this.nextScope();return j.push(a),i=null,a},binding:function(b,c,e){if(!m[b]||!m[b].readonly){var f;f="string"!=d.typeOf(c)?{namespace:a({tree:!0,root:c}),path:null}:this.resolve(c),m[b]=d.extend(e,f)}return this},resolve:function(a){var b=a.split(":");if(1==b.length)return{namespace:l,path:b[0]};var c=m[b[0]];if(!c)throw"The namespace '"+b[0]+"' has not been defined (yet).";return{namespace:c.namespace,path:c.path&&b[1]?c.path+"."+b[1]:c.path||b[1]}},define:function(){return n.call(this,arguments,"define",function(a,b){a.namespace.set(a.path,b)})},extend:function(){return n.call(this,arguments,"extend",function(a,b){a.namespace.extend(a.path,b)})},condition:function(){return n.call(this,arguments,"condition",function(a,b){b&&a.namespace.set(a.path,b)})},require:function(){var a=d.matchArgs(arguments,{dependencies:"array",hiddenDependencies:"array",callback:"function",context:"object"});a.callback=a.callback||function(){};var b=a.dependencies||[],c=b.concat(a.hiddenDependencies||[]),e=c.length,f=[],g={};if(e)for(var h=function(b){this.i<f.length&&(f[this.i]=b),e--,0===e&&(f.push(g),a.callback.apply(a.context||this.ctx,f))},i=0;i<c.length;++i){var j=this.resolve(c[i]);i<b.length&&f.push(null),j.namespace.obtain(j.path,h,{ctx:this,i:i})}else f.push(g),a.callback.apply(a.context||this,f);return this},digest:function(a){var b=this.resolve(a);return b.namespace.digest(b.path),this}}}var c={get:function(a){return"undefined"!=typeof window?window[a]:"undefined"!=typeof global?global[a]:null},set:function(a,b){return"undefined"!=typeof window&&(window[a]=b),"undefined"!=typeof global&&(global[a]=b),b},setPath:function(a,b){var c=a.split(".");if(1==c.length)return this.set(a,b);for(var d=this.get(c[0])||this.set(c[0],{}),e=1;e<c.length-1;++e)c[e]in d||(d[c[e]]={}),d=d[c[e]];return d[c[c.length-1]]=b,b},getPath:function(a){var b=a.split(".");if(1==b.length)return this.get(a);for(var c=this.get(b[0]),d=1;d<b.length;++d){if(!c)return c;c=c[b[d]]}return c}},d={method:function(a,b){return function(){return b.apply(a,arguments)}},extend:function(a,b){a=a||{},b=b||{};for(var c in b)a[c]=b[c];return a},typeOf:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":typeof a},isEmpty:function(a){if(null===a||"undefined"==typeof a)return!0;if("array"==this.typeOf(a))return 0===a.length;if("object"!=typeof a)return!1;for(var b in a)return!1;return!0},matchArgs:function(a,b){var c=0,d={};for(var e in b)b[e]===!0||this.typeOf(a[c])==b[e]?(d[e]=a[c],c++):"undefined"==this.typeOf(a[c])&&c++;return d},stringify:function(a){return"function"==this.typeOf(a)?""+a:JSON.stringify(a)}},e={__namespace:"Scoped",upgrade:function(a){var b=c.get(a||e.__namespace);if(b&&"object"==d.typeOf(b)&&b.guid==this.guid&&"string"==d.typeOf(b.version)){for(var f=this.version.split("."),g=b.version.split("."),h=!1,i=0;i<Math.min(f.length,g.length)&&(h=f[i]>g[i],f[i]==g[i]);++i);return h?this.attach(a):b}return this.attach(a)},attach:function(a){a&&(e.__namespace=a);var b=c.get(e.__namespace);return b==this?this:(e.__revert=b,c.set(e.__namespace,this),this)},detach:function(a){return a&&c.set(e.__namespace,null),"undefined"!=typeof e.__revert&&c.set(e.__namespace,e.__revert),delete e.__revert,this},exports:function(a,b,c){return a=a||("undefined"!=typeof module?module:null),"object"==typeof a&&a&&"exports"in a&&(c||a.exports==this||!a.exports||d.isEmpty(a.exports))&&(a.exports=b||this),this}},f=a({tree:!0,global:!0}),g=a({tree:!0}),h=b(null,g,g,f),i=d.extend(h,{guid:"4b6878ee-cb6a-46b3-94ac-27d91f58d666",version:"9.1427403679672",upgrade:e.upgrade,attach:e.attach,detach:e.detach,exports:e.exports});return i=i.upgrade(),i.exports(),i}.call(this);(function(){var a=this.subScope();a.binding("module","global:BetaJS.Flash"),a.binding("base","global:BetaJS"),a.binding("jquery","global:jQuery"),a.define("module:",function(){return{guid:"3adc016a-e639-4d1a-b4cb-e90cab02bc4f",version:"8.1427938858794",__global:{},options:{flashFile:"betajs-flash.swf"}}}),a.define("module:FlashEmbedding",["base:Class","jquery:","base:Strings","base:Functions","base:Types","base:Objs","base:Ids","base:Async","module:__global","module:FlashObjectWrapper","module:FlashClassWrapper","base:Browser.FlashHelper","module:"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return a.extend({scoped:n},function(a){return{constructor:function(b,c,e){a.constructor.call(this),c=c||{},this.__registry=c.registry,this.__wrap=c.wrap,this.__cache={},this.__callbacks={ready:d.as_method(this.__ready,this)},this.__namespace="BetaJS.Flash.__global."+this.cid(),this.__is_ready=!1,this.__ready_queue=[],this.__wrappers={},this.__staticWrappers={},i[this.cid()]=this.__callbacks,e=f.extend(f.clone(m.options,1),f.extend({FlashVars:{}},e)),e.FlashVars.ready=this.__namespace+".ready",this.__embedding=l.embedFlashObject(b,e)},destroy:function(){delete i[this.cid()],f.iter(this.__wrappers,function(a){a.destroy()}),f.iter(this.__staticWrappers,function(a){a.destroy()}),a.destroy.call(this)},registerCallback:function(a,b){var c="__FLASHCALLBACK__"+g.uniqueId();return this.__callbacks[c]=d.as_method(a,b||this),c},unregisterCallback:function(a){delete this.__callbacks[a]},serialize:function(a){return e.is_array(a)?f.map(a,this.serialize,this):(e.is_function(a)&&(a=this.registerCallback(a)),e.is_string(a)&&c.starts_with(a,"__FLASHCALLBACK__")&&(a=this.__namespace+"."+a),j.is_instance_of(a)&&(a=a.__ident),k.is_instance_of(a)&&(a=a.__type),a)},unserialize:function(a){if(e.is_string(a)&&c.starts_with(a,"__FLASHERR__"))throw c.strip_start(a,"__FLASHERR__");if(e.is_string(a)&&c.starts_with(a,"__FLASHOBJ__")&&this.__wrap){var b=c.strip_start(a,"__FLASHOBJ__");if(b=c.splitFirst(b,"__").head.replace("::","."),"object"!=b.toLowerCase())return a in this.__wrappers||(this.__wrappers[a]=new j(this,a,b)),this.__wrappers[a]}return a},invoke:function(a,b){if(!this.__is_ready)throw"Flash is not ready yet";return b=b||[],this.unserialize(this.__embedding[a].apply(this.__embedding,this.serialize(d.getArguments(b))))},invokeCached:function(a,b){b=b||[];var c=a+"__"+d.getArguments(b).join("__");return c in this.__cache||(this.__cache[c]=this.invoke.call(this,a,b)),this.__cache[c]},getClass:function(a){return this.__wrap?(a in this.__staticWrappers||(this.__staticWrappers[a]=new k(this,a)),this.__staticWrappers[a]):null},newObject:function(){return this.flashCreate.apply(this,arguments)},newCallback:function(){return this.flashCreateCallbackObject.apply(this,arguments)},flashCreateCallbackObject:function(){return this.invoke("create_callback_object",arguments)},flashCreate:function(){return this.invoke("create",arguments)},flashDestroy:function(){return this.invoke("destroy",arguments)},flashCall:function(){return this.invoke("call",arguments)},flashCallVoid:function(){return this.invoke("call_void",arguments)},flashGet:function(){return this.invoke("get",arguments)},flashSet:function(){return this.invoke("set",arguments)},flashStaticCall:function(){return this.invoke("static_call",arguments)},flashStaticCallVoid:function(){return this.invoke("static_call_void",arguments)},flashGetStatic:function(){return this.invoke("get_static",arguments)},flashSetStatic:function(){return this.invoke("set_static",arguments)},flashAddEventListener:function(){return this.invoke("add_event_listener",arguments)},flashMain:function(){return this.invokeCached("main")},__ready:function(){this.__is_ready||(this.__is_ready=!0,h.eventually(function(){f.iter(this.__ready_queue,function(a){a.callback.call(a.context||this)},this)},this))},ready:function(a,b){this.__is_ready?h.eventually(function(){a.call(b||this)},this):this.__ready_queue.push({callback:a,context:b})}}})}),a.define("module:FlashClassRegistry",["base:Class"],function(a,b){return a.extend({scoped:b},{interfaces:{},register:function(a,b,c){this.interfaces[a]={methods:b||{},statics:c||{}}},get:function(a){return this.interfaces[a]}})}),a.define("module:FlashObjectWrapper",["base:Class","base:Objs","base:Functions"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e,f){if(a.constructor.call(this),this.__embedding=d,this.__ident=e,this.__type=f,d.__registry){var g=d.__registry.get(f);g&&b.iter(g.methods,function(a){this[a]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__ident),this.__embedding.flashCall.apply(this.__embedding,b)},this[a+"Void"]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__ident),this.__embedding.flashCallVoid.apply(this.__embedding,b)}},this)}},destroy:function(){this.__embedding.flashDestroy(this.__ident),a.destroy.call(this)},addEventListener:function(a,b){return this.__embedding.flashAddEventListener.call(this.__embedding,this.__ident,a,b)},set:function(a,b){return this.__embedding.flashSet.call(this.__embedding,this.__ident,a,b)},get:function(a){return this.__embedding.flashGet.call(this.__embedding,this.__ident,a)}}})}),a.define("module:FlashClassWrapper",["base:Class","base:Objs","base:Functions"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e){if(a.constructor.call(this),this.__embedding=d,this.__type=e,d.__registry){var f=d.__registry.get(objectType);f&&b.iter(f.statics,function(a){this[a]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__type),this.__embedding.flashStaticCall.apply(this.__embedding,b)},this[a+"Void"]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__type),this.__embedding.flashStaticCallVoid.apply(this.__embedding,b)}},this)}},set:function(a,b){return this.__embedding.flashSetStatic.call(this.__embedding,this.__type,a,b)},get:function(a){return this.__embedding.flashGetStatic.call(this.__embedding,this.__type,a)}}})})}).call(Scoped);