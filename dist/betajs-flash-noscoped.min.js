/*!
betajs-flash - v0.0.1 - 2015-03-24
Copyright (c) Oliver Friedmann
MIT Software License.
*/
(function(){var a=this.subScope();a.binding("module","global:BetaJS.Flash"),a.binding("base","global:BetaJS"),a.binding("jquery","global:jQuery"),a.define("module:",function(){return{guid:"3adc016a-e639-4d1a-b4cb-e90cab02bc4f",version:"5.1427217271706",__global:{}}}),a.define("module:FlashEmbedding",["base:Class","jquery:","base:Strings","base:Functions","base:Types","base:Objs","base:Ids","base:Async","module:__global","module:FlashObjectWrapper","module:FlashClassWrapper","module:Helper"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){return a.extend({scoped:m},function(a){return{constructor:function(c,e,g){a.constructor.call(this),e=e||{},this.__registry=e.registry,this.__wrap=e.wrap,this.__cache={},this.__callbacks={ready:d.as_method(this.__ready,this)},this.__namespace="BetaJS.Flash.__global."+this.cid(),this.__is_ready=!1,this.__ready_queue=[],this.__wrappers={},this.__staticWrappers={},i[this.cid()]=this.__callbacks,g=f.extend({FlashVars:{}},g),g.FlashVars.ready=this.__namespace+".ready",b(c).html(l.embedTemplate(g)),this.__embedding=b(c).find("embed").get(0)},destroy:function(){delete i[this.cid()],f.iter(this.__wrappers,function(a){a.destroy()}),f.iter(this.__staticWrappers,function(a){a.destroy()}),a.destroy.call(this)},registerCallback:function(a,b){var c="__FLASHCALLBACK__"+g.uniqueId();return this.__callbacks[c]=d.as_method(a,b||this),c},unregisterCallback:function(a){delete this.__callbacks[a]},serialize:function(a){return e.is_array(a)?f.map(a,this.serialize,this):(e.is_function(a)&&(a=this.registerCallback(a)),e.is_string(a)&&c.starts_with(a,"__FLASHCALLBACK__")&&(a=this.__namespace+"."+a),j.is_instance_of(a)&&(a=a.__ident),k.is_instance_of(a)&&(a=a.__type),a)},unserialize:function(a){if(e.is_string(a)&&c.starts_with(a,"__FLASHERR__"))throw c.strip_start(a,"__FLASHERR__");if(e.is_string(a)&&c.starts_with(a,"__FLASHOBJ__")&&this.__wrap){var b=c.strip_start(a,"__FLASHOBJ__");if(b=c.splitFirst(b,"__").head.replace("::","."),"object"!=b.toLowerCase())return a in this.__wrappers||(this.__wrappers[a]=new j(this,a,b)),this.__wrappers[a]}return a},invoke:function(a,b){if(!this.__is_ready)throw"Flash is not ready yet";return b=b||[],this.unserialize(this.__embedding[a].apply(this.__embedding,this.serialize(d.getArguments(b))))},invokeCached:function(a,b){b=b||[];var c=a+"__"+d.getArguments(b).join("__");return c in this.__cache||(this.__cache[c]=this.invoke.call(this,a,b)),this.__cache[c]},getClass:function(a){return this.__wrap?(a in this.__staticWrappers||(this.__staticWrappers[a]=new k(this,a)),this.__staticWrappers[a]):null},newObject:function(){return this.flashCreate.apply(this,arguments)},newCallback:function(){return this.flashCreateCallbackObject.apply(this,arguments)},flashCreateCallbackObject:function(){return this.invoke("create_callback_object",arguments)},flashCreate:function(){return this.invoke("create",arguments)},flashDestroy:function(){return this.invoke("destroy",arguments)},flashCall:function(){return this.invoke("call",arguments)},flashCallVoid:function(){return this.invoke("call_void",arguments)},flashGet:function(){return this.invoke("get",arguments)},flashSet:function(){return this.invoke("set",arguments)},flashStaticCall:function(){return this.invoke("static_call",arguments)},flashStaticCallVoid:function(){return this.invoke("static_call_void",arguments)},flashGetStatic:function(){return this.invoke("get_static",arguments)},flashSetStatic:function(){return this.invoke("set_static",arguments)},flashAddEventListener:function(){return this.invoke("add_event_listener",arguments)},flashMain:function(){return this.invokeCached("main")},__ready:function(){this.__is_ready||(this.__is_ready=!0,h.eventually(function(){f.iter(this.__ready_queue,function(a){a.callback.call(a.context||this)},this)},this))},ready:function(a,b){this.__is_ready?h.eventually(function(){a.call(b||this)},this):this.__ready_queue.push({callback:a,context:b})}}})}),a.define("module:Helper",["base:Time","base:Objs","base:Types","base:Net.Uri"],function(a,b,c,d){return{options:{flashFile:"betajs-flash.swf"},embedTemplate:function(e){e=b.extend(b.clone(this.options,1),e);var f=[];f.push({objectKey:"classid",value:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"}),f.push({objectKey:"codebase",value:"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"}),f.push({embedKey:"align",value:"middle"}),f.push({embedKey:"play",value:"true"}),f.push({embedKey:"loop",value:"false"}),f.push({embedKey:"type",value:"application/x-shockwave-flash"}),f.push({embedKey:"pluginspage",value:"http://www.adobe.com/go/getflashplayer"}),f.push({objectParam:"quality",embedKey:"quality",value:"high"}),f.push({objectParam:"allowScriptAccess",embedKey:"allowScriptAccess",value:"always"}),f.push({objectParam:"wmode",embedKey:"wmode",value:"opaque"}),f.push({objectParam:"movie",embedKey:"src",value:e.flashFile+(e.forceReload?"?"+a.now():"")}),e.width&&f.push({objectKey:"width",embedKey:"width",value:e.width}),e.height&&f.push({objectKey:"height",embedKey:"height",value:e.height}),e.bgcolor&&f.push({objectParam:"bgcolor",embedKey:"bgcolor",value:e.bgcolor}),e.FlashVars&&f.push({objectParam:"FlashVars",embedKey:"FlashVars",value:c.is_object(e.FlashVars)?d.encodeUriParams(e.FlashVars):e.FlashVars});var g=[],h=[],i=[];return b.iter(f,function(a){a.objectKey&&g.push(a.objectKey+'="'+a.value+'"'),a.embedKey&&i.push(a.embedKey+'="'+a.value+'"'),a.objectParam&&h.push('<param name="'+a.objectParam+'" value="'+a.value+'" />')},this),"<object "+g.join(" ")+">"+h.join(" ")+"<embed "+i.join(" ")+"></embed></object>"}}}),a.define("module:FlashClassRegistry",["base:Class"],function(a,b){return a.extend({scoped:b},{interfaces:{},register:function(a,b,c){this.interfaces[a]={methods:b||{},statics:c||{}}},get:function(a){return this.interfaces[a]}})}),a.define("module:FlashObjectWrapper",["base:Class","base:Objs","base:Functions"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e,f){a.constructor.call(this),this.__embedding=d,this.__ident=e,this.__type=f,d.__registry&&b.iter(d.__registry.get(f).methods,function(a){this[a]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__ident),this.__embedding.flashCall.apply(this.__embedding,b)},this[a+"Void"]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__ident),this.__embedding.flashCallVoid.apply(this.__embedding,b)}},this)},destroy:function(){this.__embedding.flashDestroy(this.__ident),a.destroy.call(this)},addEventListener:function(a,b){return this.__embedding.flashAddEventListener.call(this.__embedding,this.__ident,a,b)},set:function(a,b){return this.__embedding.flashSet.call(this.__embedding,this.__ident,a,b)},get:function(a){return this.__embedding.flashGet.call(this.__embedding,this.__ident,a)}}})}),a.define("module:FlashClassWrapper",["base:Class","base:Objs","base:Functions"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e){a.constructor.call(this),this.__embedding=d,this.__type=e,d.__registry&&b.iter(d.__registry.get(e).statics,function(a){this[a]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__type),this.__embedding.flashStaticCall.apply(this.__embedding,b)},this[a+"Void"]=function(){var b=c.getArguments(arguments);return b.unshift(a),b.unshift(this.__type),this.__embedding.flashStaticCallVoid.apply(this.__embedding,b)}},this)},set:function(a,b){return this.__embedding.flashSetStatic.call(this.__embedding,this.__type,a,b)},get:function(a){return this.__embedding.flashGetStatic.call(this.__embedding,this.__type,a)}}})})}).call(Scoped);